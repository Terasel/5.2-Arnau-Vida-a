USE `universidad`;
SELECT nombre AS 'Nom', apellido1 AS 'Primer cognom', apellido2 AS 'Segon cognom' FROM `persona` WHERE tipo = 'alumno' ORDER BY apellido1 ASC, apellido2 ASC, nombre ASC;
SELECT nombre AS 'Nom', apellido1 AS 'Primer cognom', apellido2 AS 'Segon cognom' FROM `persona` WHERE tipo = 'alumno' AND telefono IS NULL;
SELECT nombre AS 'Nom', apellido1 AS 'Primer cognom', apellido2 AS 'Segon cognom', fecha_nacimiento AS 'Data de naixement' FROM `persona` WHERE tipo = 'alumno' AND fecha_nacimiento LIKE '1999-%';
SELECT nombre AS 'Nom', apellido1 AS 'Primer cognom', apellido2 AS 'Segon cognom', nif AS 'NIF' FROM `persona` WHERE tipo = 'profesor' AND telefono IS NULL AND nif LIKE '%K';
SELECT nombre AS 'Assignatura', cuatrimestre AS 'Quadrimestre', curso AS 'Curs', id_grado AS 'Grau' FROM `asignatura` WHERE cuatrimestre = 1 AND curso = 3 AND id_grado = 7;
SELECT pe.apellido1 AS 'Primer cognom', pe.apellido2 AS 'Segon cognom', pe.nombre AS 'Nom', de.nombre FROM `persona` pe JOIN `profesor` pr ON pe.id = pr.id_profesor JOIN `departamento` de ON pr.id_departamento = de.id ORDER BY pe.apellido1 ASC, pe.apellido2 ASC, pe.nombre ASC; 
SELECT asi.nombre AS 'Nom Assignatura', cu.anyo_inicio AS 'Any inici', cu.anyo_fin AS 'Any de fi' FROM `persona` pe JOIN `alumno_se_matricula_asignatura` al ON pe.id = al.id_alumno JOIN `asignatura` asi ON al.id_asignatura = asi.id JOIN `curso_escolar` cu ON al.id_curso_escolar = cu.id WHERE pe.nif = '26902806M';
SELECT DISTINCT de.nombre FROM `departamento` de JOIN `profesor` pr ON de.id = pr.id_departamento JOIN `asignatura` asi ON pr.id_profesor = asi.id_profesor JOIN `grado` gr ON asi.id_grado = gr.id WHERE gr.id = 4;
SELECT DISTINCT pe.nombre AS 'Nom', pe.apellido1 AS 'Primer cognom', pe.apellido2 AS 'Segon cognom' FROM `persona` pe JOIN `alumno_se_matricula_asignatura` al ON pe.id = al.id_alumno JOIN `asignatura` asi ON al.id_asignatura = asi.id JOIN `curso_escolar` cu ON al.id_curso_escolar = cu.id WHERE cu.anyo_inicio = 2018;
SELECT de.nombre AS 'Nom del departament', pe.apellido1 AS 'Primer cognom', pe.apellido2 AS 'Segon cognom', pe.nombre AS 'Nom' FROM `profesor` pr JOIN `persona` pe ON pr.id_profesor = pe.id LEFT JOIN `departamento` de ON pr.id_departamento = de.id ORDER BY de.nombre ASC, pe.apellido1 ASC, pe.apellido2 ASC, pe.nombre ASC;
SELECT de.nombre AS 'Nom del departament', pe.apellido1 AS 'Primer cognom', pe.apellido2 AS 'Segon cognom', pe.nombre AS 'Nom' FROM `profesor` pr JOIN `persona` pe ON pr.id_profesor = pe.id LEFT JOIN `departamento` de ON pr.id_departamento = de.id WHERE pr.id_departamento IS NULL ORDER BY de.nombre ASC, pe.apellido1 ASC, pe.apellido2 ASC, pe.nombre ASC;
SELECT de.nombre AS 'Nom del departament' FROM `departamento` de LEFT JOIN `profesor` pr ON de.id = pr.id_departamento WHERE pr.id_profesor IS NULL;
SELECT pe.apellido1 AS 'Primer cognom', pe.apellido2 AS 'Segon cognom', pe.nombre AS 'Nom' FROM `profesor` pr JOIN `persona` pe ON pr.id_profesor = pe.id LEFT JOIN `asignatura` asi ON pr.id_profesor = asi.id_profesor WHERE asi.id_profesor IS NULL;
SELECT asi.nombre AS 'Assignatura' FROM `profesor` pr JOIN `persona` pe ON pr.id_profesor = pe.id RIGHT JOIN `asignatura` asi ON pr.id_profesor = asi.id_profesor WHERE asi.id_profesor IS NULL;
SELECT DISTINCT de.nombre AS 'Nom del departament' FROM `departamento` de LEFT JOIN `profesor` pr ON de.id = pr.id_departamento LEFT JOIN `asignatura` asi ON pr.id_profesor = asi.id_profesor LEFT JOIN `alumno_se_matricula_asignatura` al ON asi.id = al.id_asignatura WHERE asi.nombre IS NULL;
SELECT COUNT(id) AS 'Nombre total alumnes' FROM `persona` WHERE tipo = 'alumno';
SELECT COUNT(id) AS 'Nombre total alumnes' FROM `persona` WHERE tipo = 'alumno' AND fecha_nacimiento LIKE '1999%';
SELECT de.nombre AS 'Nom departament', COUNT(de.id) AS 'Nombre professors' FROM `profesor` pr JOIN `departamento` de ON pr.id_departamento = de.id GROUP BY de.nombre ORDER BY COUNT(de.id) DESC;
SELECT de.nombre AS 'Nom departament', COUNT(pr.id_profesor) AS 'Nombre professors' FROM `profesor` pr RIGHT JOIN `departamento` de ON pr.id_departamento = de.id GROUP BY de.id;
SELECT gr.nombre AS 'Nom grau', COUNT(asi.nombre) AS 'Nombre assignatures' FROM `grado` gr LEFT JOIN `asignatura` asi ON gr.id = asi.id_grado GROUP BY gr.id ORDER BY COUNT(asi.nombre) DESC;